generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  // For the purpose of this example, we'll use the name as the unique identifier
  name      String @id
  avatarUrl String

  notifications Notification[]
}

enum NotificationTypeIdentifier {
  PlatformUpdate
  CommentTag
  AccessGranted
  JoinWorkspace
}

enum NotificationActionType {
  OpenUrl
  Alert
}

model NotificationType {
  typeIdentifier  NotificationTypeIdentifier @id
  messageTemplate String
  actionType      NotificationActionType
  actionTemplate  String?

  notifications Notification[]
}

model Notification {
  id             Int      @id @default(autoincrement())
  read           Boolean  @default(false)
  createdAt      DateTime @default(now())
  additionalData Json?

  typeIdentifier NotificationTypeIdentifier
  type           NotificationType           @relation(fields: [typeIdentifier], references: [typeIdentifier])
  senderName     String?
  sender         User?                      @relation(fields: [senderName], references: [name])
}
